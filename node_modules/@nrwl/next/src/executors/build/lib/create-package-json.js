"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createPackageJson = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nrwl/devkit");
const create_package_json_1 = require("@nrwl/workspace/src/utilities/create-package-json");
function createPackageJson(options, context) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const packageJson = (0, create_package_json_1.createPackageJson)(context.projectName, context.projectGraph, {
            root: context.root,
            projectRoot: context.workspace.projects[context.projectName].sourceRoot,
        });
        // By default we remove devDependencies since this is a production build.
        if (!options.includeDevDependenciesInPackageJson) {
            delete packageJson.devDependencies;
        }
        if (!packageJson.scripts) {
            packageJson.scripts = {};
        }
        packageJson.scripts.start = 'next start';
        const typescriptNode = context.projectGraph.externalNodes['npm:typescript'];
        if (typescriptNode) {
            packageJson.dependencies['typescript'] = typescriptNode.data.version;
        }
        (0, devkit_1.writeJsonFile)(`${options.outputPath}/package.json`, packageJson);
    });
}
exports.createPackageJson = createPackageJson;
//# sourceMappingURL=create-package-json.js.map