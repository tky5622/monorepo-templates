const a7_0x29ce=['maxParallel','mapRespToPerfEntry','recordMetric','true','/nx-cloud/executions/start','serializeOverrides','configuration','map','completeRunGroup','apiAxiosInstance','enabled','done','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','target','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','createApiAxiosInstance','status','/nx-cloud/executions/status','completeRunGroupWithError','Completing\x20run\x20group\x20with\x20an\x20error','error:\x20','getBranch','../../../utilities/environment','post','../../../utilities/serializer-overrides','exit','parallel','stringify','/nx-cloud/executions/complete-run-group','agentCount','message','throw','axiosMultipleTries','createStartRequest','../../../utilities/axios','data','../../../utilities/nx-imports','DistributedExecutionApi','response','apply','RUNNER_FAILURE_PERF_ENTRY','axiosException','Starting\x20a\x20distributed\x20execution','value','__esModule','false','note','runGroup:\x20','createMetricRecorder','stopAgentsOnFailure','error','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','VERBOSE_LOGGING','project','../../../utilities/metric-logger'];(function(_0x4de33d,_0x29cea9){const _0x3bc766=function(_0x5ee584){while(--_0x5ee584){_0x4de33d['push'](_0x4de33d['shift']());}};_0x3bc766(++_0x29cea9);}(a7_0x29ce,0x1ab));const a7_0x3bc7=function(_0x4de33d,_0x29cea9){_0x4de33d=_0x4de33d-0x0;let _0x3bc766=a7_0x29ce[_0x4de33d];return _0x3bc766;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x4a496e,_0x197558,_0x2dc703,_0x57686e){function _0x33edab(_0x183456){return _0x183456 instanceof _0x2dc703?_0x183456:new _0x2dc703(function(_0x54a6dc){_0x54a6dc(_0x183456);});}return new(_0x2dc703||(_0x2dc703=Promise))(function(_0x4864e1,_0x434a56){function _0x41825f(_0x34e764){try{_0x1671c9(_0x57686e['next'](_0x34e764));}catch(_0x292e30){_0x434a56(_0x292e30);}}function _0x5272a4(_0x441935){try{_0x1671c9(_0x57686e[a7_0x3bc7('0x2c')](_0x441935));}catch(_0x31442c){_0x434a56(_0x31442c);}}function _0x1671c9(_0x4e8892){_0x4e8892[a7_0x3bc7('0x18')]?_0x4864e1(_0x4e8892[a7_0x3bc7('0x1')]):_0x33edab(_0x4e8892[a7_0x3bc7('0x1')])['then'](_0x41825f,_0x5272a4);}_0x1671c9((_0x57686e=_0x57686e[a7_0x3bc7('0x34')](_0x4a496e,_0x197558||[]))['next']());});};Object['defineProperty'](exports,a7_0x3bc7('0x2'),{'value':!![]});exports[a7_0x3bc7('0x2e')]=exports[a7_0x3bc7('0x32')]=void 0x0;const axios_1=require(a7_0x3bc7('0x2f'));const environment_1=require(a7_0x3bc7('0x23'));const metric_logger_1=require(a7_0x3bc7('0xc'));const serializer_overrides_1=require(a7_0x3bc7('0x25'));const {output}=require(a7_0x3bc7('0x31'));class DistributedExecutionApi{constructor(_0x115bd8){this[a7_0x3bc7('0x16')]=(0x0,axios_1[a7_0x3bc7('0x1c')])(_0x115bd8);}['start'](_0x2b44f6){var _0x1ed530;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4f218a=(0x0,metric_logger_1[a7_0x3bc7('0x6')])('dteStart');let _0x1a3eba;if(environment_1['VERBOSE_LOGGING']){output['note']({'title':a7_0x3bc7('0x0'),'bodyLines':[JSON[a7_0x3bc7('0x28')](_0x2b44f6,null,0x2)]});}try{_0x1a3eba=yield(0x0,axios_1[a7_0x3bc7('0x2d')])(()=>this['apiAxiosInstance'][a7_0x3bc7('0x24')](a7_0x3bc7('0x11'),_0x2b44f6));_0x4f218a[a7_0x3bc7('0xf')]((0x0,metric_logger_1[a7_0x3bc7('0xe')])(_0x1a3eba));}catch(_0x5d4563){_0x4f218a['recordMetric'](((_0x1ed530=_0x5d4563===null||_0x5d4563===void 0x0?void 0x0:_0x5d4563[a7_0x3bc7('0x36')])===null||_0x1ed530===void 0x0?void 0x0:_0x1ed530['response'])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x5d4563[a7_0x3bc7('0x36')]['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x5d4563;}if(!_0x1a3eba[a7_0x3bc7('0x30')][a7_0x3bc7('0x17')]){throw new Error(a7_0x3bc7('0x19'));}if(_0x1a3eba['data'][a7_0x3bc7('0x8')]){throw new Error(_0x1a3eba[a7_0x3bc7('0x30')][a7_0x3bc7('0x8')]);}return _0x1a3eba['data']['id'];});}[a7_0x3bc7('0x1d')](_0x54d22b){var _0x4151da;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1ded68=(0x0,metric_logger_1['createMetricRecorder'])('dteStatus');try{const _0x17845b=yield(0x0,axios_1[a7_0x3bc7('0x2d')])(()=>this[a7_0x3bc7('0x16')][a7_0x3bc7('0x24')](a7_0x3bc7('0x1e'),{'id':_0x54d22b}));_0x1ded68[a7_0x3bc7('0xf')]((0x0,metric_logger_1[a7_0x3bc7('0xe')])(_0x17845b));return _0x17845b[a7_0x3bc7('0x30')];}catch(_0x5a413d){_0x1ded68[a7_0x3bc7('0xf')](((_0x4151da=_0x5a413d===null||_0x5a413d===void 0x0?void 0x0:_0x5a413d[a7_0x3bc7('0x36')])===null||_0x4151da===void 0x0?void 0x0:_0x4151da['response'])?(0x0,metric_logger_1[a7_0x3bc7('0xe')])(_0x5a413d[a7_0x3bc7('0x36')][a7_0x3bc7('0x33')]):metric_logger_1[a7_0x3bc7('0x35')]);output[a7_0x3bc7('0x8')]({'title':_0x5a413d[a7_0x3bc7('0x2b')]});process[a7_0x3bc7('0x26')](0x1);}});}[a7_0x3bc7('0x1f')](_0x36b5e8,_0xfa0a6c){var _0x3c4b5b;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x307d07=(0x0,metric_logger_1[a7_0x3bc7('0x6')])(a7_0x3bc7('0x15'));if(environment_1[a7_0x3bc7('0xa')]){output[a7_0x3bc7('0x4')]({'title':a7_0x3bc7('0x20'),'bodyLines':[a7_0x3bc7('0x5')+_0x36b5e8,a7_0x3bc7('0x21')+_0xfa0a6c]});}try{const _0x5958b6=yield(0x0,axios_1[a7_0x3bc7('0x2d')])(()=>this['apiAxiosInstance'][a7_0x3bc7('0x24')](a7_0x3bc7('0x29'),{'runGroup':_0x36b5e8,'criticalErrorMessage':_0xfa0a6c}),0x3);_0x307d07['recordMetric']((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x5958b6));}catch(_0x5b7e27){_0x307d07[a7_0x3bc7('0xf')](((_0x3c4b5b=_0x5b7e27===null||_0x5b7e27===void 0x0?void 0x0:_0x5b7e27['axiosException'])===null||_0x3c4b5b===void 0x0?void 0x0:_0x3c4b5b[a7_0x3bc7('0x33')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x5b7e27[a7_0x3bc7('0x36')][a7_0x3bc7('0x33')]):metric_logger_1[a7_0x3bc7('0x35')]);}});}}exports[a7_0x3bc7('0x32')]=DistributedExecutionApi;function createStartRequest(_0x365db6,_0x225d4b,_0x5d3199){const _0x48924e=_0x225d4b['map'](_0x33bf4e=>{return _0x33bf4e[a7_0x3bc7('0x14')](_0x592508=>{return{'taskId':_0x592508['id'],'hash':_0x592508['hash'],'projectName':_0x592508[a7_0x3bc7('0x1a')][a7_0x3bc7('0xb')],'target':_0x592508[a7_0x3bc7('0x1a')][a7_0x3bc7('0x1a')],'configuration':_0x592508[a7_0x3bc7('0x1a')][a7_0x3bc7('0x13')]||null,'params':(0x0,serializer_overrides_1[a7_0x3bc7('0x12')])(_0x592508)};});});const _0x1ce064={'command':(0x0,environment_1['parseCommand'])(),'branch':(0x0,environment_1[a7_0x3bc7('0x22')])(),'runGroup':_0x365db6,'tasks':_0x48924e,'maxParallel':calculateMaxParallel(_0x5d3199)};if(environment_1[a7_0x3bc7('0x9')]){_0x1ce064[a7_0x3bc7('0x2a')]=environment_1[a7_0x3bc7('0x9')];}if(!environment_1[a7_0x3bc7('0x1b')]){_0x1ce064[a7_0x3bc7('0x7')]=![];}return _0x1ce064;}exports[a7_0x3bc7('0x2e')]=createStartRequest;function calculateMaxParallel(_0x4ec181){if(_0x4ec181['parallel']===a7_0x3bc7('0x3')||_0x4ec181[a7_0x3bc7('0x27')]===![]){return 0x1;}else if(_0x4ec181[a7_0x3bc7('0x27')]===a7_0x3bc7('0x10')||_0x4ec181[a7_0x3bc7('0x27')]===!![]){return Number(_0x4ec181['maxParallel']||0x3);}else if(_0x4ec181['parallel']===undefined){return _0x4ec181['maxParallel']?Number(_0x4ec181[a7_0x3bc7('0xd')]):0x3;}else{return Number(_0x4ec181['parallel'])||0x3;}}