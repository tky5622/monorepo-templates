"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),n=e(require("rsuite/CustomProvider")),r=require("unreal-pixel-streaming"),o=e(require("url-parse")),i=e(require("moment")),a=e(require("rsuite/Notification")),c=e(require("rsuite/toaster")),s=require("react-jss"),l=require("react-hotkeys-hook"),u=e(require("rsuite/IconButton")),d=e(require("@rsuite/icons/Gear")),m=e(require("rsuite/Drawer")),f=e(require("rsuite/Sidenav")),p=e(require("rsuite/Nav")),v=e(require("@rsuite/icons/List")),h=e(require("@rsuite/icons/History")),g=e(require("@rsuite/icons/Setting")),y=e(require("@rsuite/icons/PlayOutline")),E=e(require("@rsuite/icons/Project")),w=e(require("react-json-view")),b=e(require("@rsuite/icons/Copy")),C=e(require("rsuite/Button")),S=e(require("rsuite/Form")),k=e(require("rsuite/Toggle")),x=e(require("rsuite/ButtonToolbar")),T=e(require("rsuite/SelectPicker")),I=e(require("rsuite/Input")),L=e(require("rsuite/Message")),N=e(require("rsuite/Modal")),D=e(require("rsuite/Progress")),A=require("@fortawesome/react-fontawesome"),M=require("@fortawesome/free-solid-svg-icons"),P=e(require("rsuite/InputGroup")),R=e(require("react-qr-code")),B=e(require("rsuite/Popover")),O=e(require("rsuite/Whisper")),U=e(require("rsuite/Slider")),z=e(require("rsuite/Navbar")),j=e(require("rsuite/Dropdown")),H=e(require("rsuite/Animation"));function F(){F=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=Object.create((t&&t.prototype instanceof d?t:d).prototype),i=new S(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=w(a,n);if(c){if(c===u)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===u)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,i),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function d(){}function m(){}function f(){}var p={};c(p,o,(function(){return this}));var v=Object.getPrototypeOf,h=v&&v(v(k([])));h&&h!==t&&n.call(h,o)&&(p=h);var g=f.prototype=d.prototype=Object.create(p);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;this._invoke=function(o,i){function a(){return new t((function(r,a){!function r(o,i,a,c){var s=l(e[o],e,i);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return m.prototype=f,c(g,"constructor",f),c(f,"constructor",m),m.displayName=c(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},y(E.prototype),c(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(g),c(g,a,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function Q(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Q(i,r,o,a,c,"next",e)}function c(e){Q(i,r,o,a,c,"throw",e)}a(void 0)}))}}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function V(e,t){var n,r;e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n=e,r=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,r)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Z(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var J,X,Y=function(){function e(e,t){this.rootDiv=e,this.rootElement=t,this.rootElement.classList.add("hiddenState"),this.rootDiv.appendChild(this.rootElement)}var t=e.prototype;return t.show=function(){this.rootElement.classList.remove("hiddenState")},t.hide=function(){this.rootElement.classList.add("hiddenState")},e}(),$=function(e){function t(t,n,r){var o;return(o=e.call(this)||this).rootDiv=t,o.rootElement=n,o.textElement=r,o.rootElement.appendChild(o.textElement),o.rootElement.classList.add("hiddenState"),o.rootDiv.appendChild(o.rootElement),o}V(t,e);var n=t.prototype;return n.show=function(){this.rootElement.classList.remove("hiddenState")},n.hide=function(){this.rootElement.classList.add("hiddenState")},t}(r.ActionOverlay),ee=function(e){function t(t,n,r,o){var i;return(i=e.call(this)||this).rootDiv=t,i.rootElement=n,i.countDownSpanElementId=o,i.textElement=r,i.rootElement.appendChild(i.textElement),i.rootElement.classList.add("hiddenState"),i.rootDiv.appendChild(i.rootElement),i}V(t,e);var n=t.prototype;return n.show=function(){this.rootElement.classList.remove("hiddenState")},n.hide=function(){this.rootElement.classList.add("hiddenState")},n.update=function(e){document.getElementById(this.countDownSpanElementId).innerHTML=e.toString()},t}(r.AfkOverlay),te=function(e){function t(t,n,r){var o;return(o=e.call(this,t,n)||this).textElement=r,o.rootElement.appendChild(o.textElement),o}return V(t,e),t.prototype.update=function(e){null==e&&null==e||(this.textElement.innerHTML=e)},t}(Y),ne=function(e){function t(t){var n;return(n=e.call(this,t)||this).statusLight=document.getElementById("qualityStatus"),n.forceTurnToggle=document.getElementById("force-turn-tgl"),n.qualityControlOwnershipCheckBox=document.getElementById("quality-control-ownership-tgl"),n.toggleMatchViewPortRes=document.getElementById("match-viewport-res-tgl"),n.controlSchemeToggle=document.getElementById("control-scheme-tgl"),n.controlSchemeToggleTitle=document.getElementById("control-scheme-title"),n.uiDescriptorText=document.getElementById("ui-descriptor-text"),n.encoderMinQpText=document.getElementById("encoder-min-qp-text"),n.encoderMaxQpText=document.getElementById("encoder-max-qp-text"),n.webRtcFpsText=document.getElementById("webrtc-fps-text"),n.webRtcMinBitrateText=document.getElementById("webrtc-min-bitrate-text"),n.webRtcMaxBitrateText=document.getElementById("webrtc-max-bitrate-text"),n.sendStatsToServer=document.getElementById("send-stats-tgl"),n.preStreamContainer=document.getElementById("preStreamOptionsHeader"),n.viewSettingsHeader=document.getElementById("viewSettingsHeader"),n.commandsHeader=document.getElementById("commandsHeader"),n.streamingSettingsHeader=document.getElementById("streamingSettingsHeader"),n.statsHeader=document.getElementById("statisticsHeader"),n.latencyHeader=document.getElementById("latencyTestHeader"),n.viewSettingsContainer=document.getElementById("viewSettingsContainer"),n.commandsContainer=document.getElementById("commandsContainer"),n.streamingSettingsContainer=document.getElementById("streamingSettingsContainer"),n.statsContainer=document.getElementById("statisticsContainer"),n.latencyContainer=document.getElementById("latencyTestContainer"),n.showStats=!0,n.logging=!1,n.videoEncoderAvgQP=-1,n.buildConnectOverlay(),n.buildPlayOverlay(),n.buildAfkOverlay(),n.buildInfoOverlay(),n.buildErrorOverlay(),n.ConfigureButtons(),n}V(t,e);var n=t.prototype;return n.buildConnectOverlay=function(){var e=this,t=document.createElement("div");t.id="connectOverlay",t.className="clickableState",t.addEventListener("click",(function(t){e.onConnectAction()}));var n=document.createElement("div");n.id="connectButton",n.innerHTML="Click to start",this.connectOverlay=new $(this.config.playerElement,t,n)},n.buildPlayOverlay=function(){var e=this,t=document.createElement("div");t.id="playOverlay",t.className="clickableState",t.addEventListener("click",(function(t){e.onPlayAction()}));var n=document.createElement("img");n.id="playButton",n.src=re.playButton,n.alt="Start Streaming",this.playOverlay=new $(this.config.playerElement,t,n)},n.buildAfkOverlay=function(){var e=this,t=document.createElement("div");t.id="afkOverlay",t.className="clickableState",t.addEventListener("click",(function(t){e.onAfkAction()}));var n=document.createElement("div");n.id="afkOverlayInner",n.innerHTML='<center>No activity detected<br>Disconnecting in <span id="afkCountDownNumber"></span> seconds<br>Click to continue<br></center>',this.afkOverlay=new ee(this.config.playerElement,t,n,"afkCountDownNumber")},n.buildInfoOverlay=function(){var e=document.createElement("div");e.id="infoOverlay",e.className="textDisplayState";var t=document.createElement("div");t.id="messageOverlayInner",this.infoOverlay=new te(this.config.playerElement,e,t)},n.buildErrorOverlay=function(){var e=document.createElement("div");e.id="errorOverlay",e.className="textDisplayState";var t=document.createElement("div");t.id="errorOverlayInner",t.classList.add(".text-danger"),this.errorOverlay=new te(this.config.playerElement,e,t)},n.onInstanceStateChange=function(e){var t="",n=!1,o=!1;switch(e.state){case r.InstanceState.UNALLOCATED:t="Instance Unallocated: "+e.details;break;case r.InstanceState.FAILED:t="UE Instance Failed: "+e.details,o=!0;break;case r.InstanceState.PENDING:n=!0,t=null==e.details||null==e.details?"Your application is pending":e.details;break;case r.InstanceState.READY:t="Instance is Ready: "+e.details;break;default:t="Unhandled Instance State"+e.state+" "+e.details}if(o)this.showErrorOverlay(t);else if(n){if(document.getElementById("loading-spinner"))return;var i=document.createElement("span");i.className="visually-hidden",i.innerHTML="Loading...";var a=document.createElement("div");a.id="loading-spinner",a.className="spinner-border ms-2",a.setAttribute("role","status"),a.appendChild(i),this.showTextOverlay(t+a.outerHTML)}else this.showTextOverlay(t)},n.onAuthenticationResponse=function(e){var t="",n=!1;switch(e.outcome){case r.MessageAuthResponseOutcomeType.AUTHENTICATED:t="Authentication has succeeded. Requesting Instance";break;case r.MessageAuthResponseOutcomeType.INVALID_TOKEN:t="Invalid Token: "+e.error,n=!0;break;case r.MessageAuthResponseOutcomeType.REDIRECT:t="Redirecting to: "+e.redirect;break;case r.MessageAuthResponseOutcomeType.ERROR:t="Error: "+e.error,n=!0;break;default:t="Unhandled Auth Response: "+e.outcome}n?this.showErrorOverlay(t):this.showTextOverlay(t)},n.ConfigureButtons=function(){var e=this;this.setUpToggleWithUrlParams(this.forceTurnToggle,"ForceTURN"),this.setUpControlSchemeTypeToggle(this.controlSchemeToggle),document.getElementById("restart-stream-button").onclick=function(){e.iWebRtcController.restartStreamAutomaticity()},document.getElementById("btn-streaming-settings").onclick=function(){console.debug("--------  Sending Streaming settings  --------");var t={MinQP:Number(e.encoderMinQpText.value),MaxQP:Number(e.encoderMaxQpText.value)},n={FPS:Number(e.webRtcFpsText.value),MinBitrate:1e3*Number(e.webRtcMinBitrateText.value),MaxBitrate:1e3*Number(e.webRtcMaxBitrateText.value)};e.iWebRtcController.sendEncoderSettings(t),e.iWebRtcController.sendWebRtcSettings(n),console.debug("-------------------------------------------")},document.getElementById("sendUiDescriptor").onclick=function(){e.iWebRtcController.sendUeUiDescriptor(e.uiDescriptorText.value)},document.getElementById("show-fps-button").onclick=function(){e.iWebRtcController.sendShowFps()},document.getElementById("enlarge-display-to-fill-window-tgl").onchange=function(){e.iWebRtcController.resizePlayerStyle()},this.toggleMatchViewPortRes.onchange=function(){e.iWebRtcController.matchViewportResolution=e.toggleMatchViewPortRes.checked},this.qualityControlOwnershipCheckBox.onchange=function(){!1===e.qualityControlOwnershipCheckBox.checked&&e.iWebRtcController.sendRequestQualityControlOwnership()},document.getElementById("overlayButton").onclick=function(){document.getElementById("overlaySettings").classList.toggle("d-none")}},n.setUpControlSchemeTypeToggle=function(e){var t=this;e&&(this.config.controlScheme===r.ControlSchemeType.LockedMouse?(this.controlSchemeToggleTitle.innerHTML="Control Scheme: Locked Mouse",this.controlSchemeToggle.checked=!1):(this.controlSchemeToggleTitle.innerHTML="Control Scheme: Hovering Mouse",this.controlSchemeToggle.checked=!0),e.onchange=function(){!0===e.checked?(t.controlSchemeToggleTitle.innerHTML="Control Scheme: Hovering Mouse",t.config.controlScheme=r.ControlSchemeType.HoveringMouse,t.iWebRtcController.activateRegisterMouse()):(t.controlSchemeToggleTitle.innerHTML="Control Scheme: Locked Mouse",t.config.controlScheme=r.ControlSchemeType.LockedMouse,t.iWebRtcController.activateRegisterMouse())})},n.setUpToggleWithUrlParams=function(e,t){e&&(e.checked=new URLSearchParams(window.location.search).has(t),e.onchange=function(){var n=new URLSearchParams(window.location.search);!0===e.checked?n.set(t,"true"):n.delete(t),window.history.replaceState({},"",""!==n.toString()?location.pathname+"?"+n:""+location.pathname)})},n.IsLinkSharingEnabled=function(){var e=q(F().mark((function e(){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.onVideoInitialised=function(){var e=this;document.getElementById("btn-start-latency-test").onclick=function(){e.iWebRtcController.sendLatencyTest()},this.viewSettingsHeader.onclick=function(){e.viewSettingsContainer.classList.contains("d-none")?e.viewSettingsContainer.classList.remove("d-none"):e.viewSettingsContainer.classList.add("d-none")},this.commandsHeader.onclick=function(){e.commandsContainer.classList.contains("d-none")?e.commandsContainer.classList.remove("d-none"):e.commandsContainer.classList.add("d-none")},this.streamingSettingsHeader.onclick=function(){e.streamingSettingsContainer.classList.contains("d-none")?e.streamingSettingsContainer.classList.remove("d-none"):e.streamingSettingsContainer.classList.add("d-none")},this.statsHeader.onclick=function(){e.statsContainer.classList.contains("d-none")?e.statsContainer.classList.remove("d-none"):e.statsContainer.classList.add("d-none")},this.latencyHeader.onclick=function(){e.latencyContainer.classList.contains("d-none")?e.latencyContainer.classList.remove("d-none"):e.latencyContainer.classList.add("d-none")},this.viewSettingsContainer.classList.remove("d-none"),this.commandsContainer.classList.remove("d-none"),this.streamingSettingsContainer.classList.remove("d-none"),this.statsContainer.classList.remove("d-none"),this.videoStartTime=Date.now()},n.onDisconnect=function(t){e.prototype.onDisconnect.call(this,t),this.onVideoEncoderAvgQP(-1),document.getElementById("btn-start-latency-test").onclick=function(){},this.viewSettingsHeader.onclick=function(){},this.commandsHeader.onclick=function(){},this.streamingSettingsHeader.onclick=function(){},this.statsHeader.onclick=function(){},this.latencyHeader.onclick=function(){},this.viewSettingsContainer.classList.add("d-none"),this.commandsContainer.classList.add("d-none"),this.streamingSettingsContainer.classList.add("d-none"),this.statsContainer.classList.add("d-none")},n.onInitialSettings=function(e){e.Encoder&&(this.encoderMinQpText.value=e.Encoder.MinQP.toString(),this.encoderMaxQpText.value=e.Encoder.MaxQP.toString()),e.WebRTC&&(this.webRtcMinBitrateText.value=e.WebRTC.MinBitrate.toString(),this.webRtcMaxBitrateText.value=e.WebRTC.MaxBitrate.toString(),this.webRtcFpsText.value=e.WebRTC.FPS.toString())},n.onVideoStats=function(e){var t="";t+="<div>Duration: "+new Date(Date.now()-this.videoStartTime).toISOString().substr(11,8)+"</div>",t+="<div>Inbound Video Data Received: "+this.formatBytes(e.inboundVideoStats.bytesReceived,2)+"</div>",t+="<div>Packets Lost: "+e.inboundVideoStats.packetsLost+"</div>",t+="<div>Bitrate (kbps): "+e.inboundVideoStats.bitrate+"</div>",t+="<div>Framerate: "+e.inboundVideoStats.framerate+"</div>",t+="<div>Frames dropped: "+e.inboundVideoStats.framesDropped+"</div>",t+="<div>Net RTT (ms): "+e.candidatePair.currentRoundTripTime+"</div>",t+="<div>Browser receive to composite (ms): "+e.inboundVideoStats.receiveToCompositeMs+"</div>",t+="<div>Video Quantization Parameter: "+this.videoEncoderAvgQP+"</div>",document.getElementById("statisticsResult").innerHTML=t,this.logging&&r.Logger.verboseLog("--------- Stats ---------\n "+e+"\n------------------------"),!0===this.sendStatsToServer.checked&&this.iWebRtcController.sendStatsToSignallingServer(e)},n.formatBytes=function(e,t){if(0===e)return"0";var n=t<0?0:t,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(n))+" "+["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][r]},n.onLatencyTestResult=function(e){console.log(e);var t="";t+="<div>Net latency RTT (ms): "+e.networkLatency+"</div>",t+="<div>UE Encode (ms): "+e.EncodeMs+"</div>",t+="<div>UE Capture (ms): "+e.CaptureToSendMs+"</div>",t+="<div>Browser send latency (ms): "+e.browserSendLatency+"</div>",t+=e.frameDisplayDeltaTimeMs&&e.browserReceiptTimeMs?"<div>Browser receive latency (ms): "+e.frameDisplayDeltaTimeMs+"</div>":"",t+="<div>Total latency (excluding browser) (ms): "+e.latencyExcludingDecode+"</div>",t+=e.endToEndLatency?"<div>Total latency (ms): "+e.endToEndLatency+"</div>":"",this.latencyContainer.classList.remove("d-none"),document.getElementById("latencyStatsResults").innerHTML=t},n.onVideoEncoderAvgQP=function(e){this.videoEncoderAvgQP=e,this.statusLight.style.color=J.None,this.statusLight.title="QP: "+e,e>X.Bad?(this.statusLight.style.color=J.Bad,this.statusLight.title+=" - Bad",this.BlinkVideoQualityStatus(2)):e>X.Spotty?(this.statusLight.style.color=J.Spotty,this.statusLight.title+=" - Spotty",this.BlinkVideoQualityStatus(1)):e<0?(this.statusLight.style.color=J.None,this.statusLight.title+=" - Error",console.error("Video Encoder QP can not be less then 0")):(this.statusLight.title+=" - Good",this.statusLight.style.color=J.Good)},n.onQualityControlOwnership=function(e){this.qualityControlOwnershipCheckBox.checked=e},n.BlinkVideoQualityStatus=function(e){var t=this,n=e,r=1,o=setInterval((function(){r-=.1,t.statusLight.style.opacity=String(Math.abs(2*(r-.5))),r<=.1&&(0==--n?clearInterval(o):r=1)}),100/e)},n.afkConnect=function(){this.iWebRtcController.connectToSignallingSever()},n.sendEncoderSettings=function(e){this.iWebRtcController.sendEncoderSettings(e)},n.sendWebRtcSettings=function(e){this.iWebRtcController.sendWebRtcSettings(e)},t}(r.DelegateBase);!function(e){e.Good="lime",e.Spotty="orange",e.Bad="red",e.None="black"}(J||(J={})),function(e){e[e.Spotty=26]="Spotty",e[e.Bad=35]="Bad"}(X||(X={}));var re=function(){};re.playButton="data:image/png;base64,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";var oe=r.Logger,ie=r.EventsClass,ae=function(){function e(e,t){this.streamingUrl=e,this.psConfig=t}return e.prototype.init=function(){var e=this,t=o(this.streamingUrl,!0),n="ws:";"https:"===t.protocol&&(n="wss:");var i=function(t,n){var o=new r.Config(t,"player"),i=function(t,n){var r=e.psConfig;return void 0!==t&&r.hasOwnProperty(t)?r[t]:n};return r.Config._enableVerboseLogging=i("enableVerboseLogging",!1),o.enableSpsAutoplay=i("enableSpsAutoplay",!0),o.startVideoMuted=i("startVideoMuted",!1),o.controlScheme=i("controlScheme",r.ControlSchemeType.HoveringMouse),o.suppressBrowserKeys=i("suppressBrowserKeys",!0),o.fakeMouseWithTouches=i("fakeMouseWithTouches",!0),o}(n+"//"+t.hostname),a=function(e,t){return new r.webRtcPlayerController(e,t)}(i,new ne(i));return document.ontouchmove=function(e){e.preventDefault()},window.RTCPlayer=a,a},e}(),ce=new(function(){function e(){}var t=e.prototype;return t.clientCb=function(e){this.client&&e(this.client)},t.connect=function(){this.clientCb((function(e){e.delegate.afkConnect()}))},t.close=function(){this.clientCb((function(e){e.afkLogic.closeWebSocket()}))},t.emitCommand=function(e,t){if(this.client)return oe.verboseLog("emitCommand()\n"+JSON.stringify({command:e,value:t},null,4)),this.client.ueDescriptorUi.emitCommand(e,t)},t.emitCommandSystem=function(e,t){if(this.client)return oe.verboseLog("emitCommandSystem()\n"+JSON.stringify({command:e,payload:t},null,4)),this.client.ueDescriptorUi.emitCommandSystem(e,t)},t.emitConsole=function(e){if(this.client)return oe.verboseLog("EmitConsole()\n"+JSON.stringify(e,null,4)),this.client.ueDescriptorUi.emitConsole(e)},t.restartStreamAutomaticity=function(){oe.verboseLog("restartStreamAutomaticity()"),this.clientCb((function(e){e.iWebRTCController.restartStreamAutomaticity()}))},W(e,[{key:"client",get:function(){var e=window.RTCPlayer;return null!=e&&e.ueDescriptorUi?e:null}}]),e}()),se={commands_list:[],callbacks_list:[],config:{streamingUrl:null,secondsToKill:null,secondsToKillLeft:null,secondsToStart:null,autoRestart:null},psConfig:null,ueSettings:{initial:null,onStart:null},playerSettings:{volume:1},webrtcData:{status:null,statusUpdatedAt:null,errorCode:null,autoplaySupport:null},mouseEvent:{moving:!1}};function le(e,t){var n=t.type,r=t.payload;if("UPDATE"===n)return G({},e,r);if("UPDATE_CONFIG"===n)return e.config=G({},e.config,r),G({},e);if("UPDATE_PS_CONFIG"===n)return e.psConfig=G({},e.psConfig,r),G({},e);if("UPDATE_UE_SETTINGS_INITIAL"===n)return e.ueSettings.initial=G({},e.ueSettings.initial,r),G({},e);if("UPDATE_UE_SETTINGS_ONSTART"===n)return e.ueSettings.onStart=G({},e.ueSettings.onStart,r),G({},e);if("UPDATE_PLAYER_SETTINGS"===n)return e.playerSettings=G({},e.playerSettings,r),G({},e);if("WEBRTC_STATUS"===n){var o=ie.webrtcStatusList;return[o.disconnected,o.error].includes(null==r?void 0:r.status)||(r.errorCode=null),(null==r?void 0:r.status)==o.initialized_no_autoplay?(r.status=o.initialized,r.autoplaySupport=!1):(null==r?void 0:r.status)==o.initialized&&(r.autoplaySupport=!0),e.webrtcData=G({},e.webrtcData,r,{statusUpdatedAt:i().utc()}),G({},e)}if("COMMANDS_LIST"===n)return r.confirmed=!1,me(e,"commands_list",r);if("CALLBACKS_LIST"===n)return me(e,"callbacks_list",r);if("COMMAND_CONFIRMATION"===n)return de(e,r);if("MOUSE_EVENT"===n){var a=null==r?void 0:r.variant;if(a){if("moveStart"===a)return e.mouseEvent.moving=!0,G({},e);if("moveStop"===a)return e.mouseEvent.moving=!1,G({},e)}}return e}var ue,de=function(e,t){for(var n in e.commands_list){var r=e.commands_list[n];if((null==r?void 0:r.verification_id)===t)return e.commands_list[n].confirmed=!0,G({},e)}return e},me=function(e,t,n){var r=e[t]||[];if(null==n||!n.verification_id||"system"===(null==n?void 0:n.initiator))return e;for(var o,i=!0,a=K(r);!(o=a()).done;){var c=o.value;if(null!=c&&c.verification_id&&null!=n&&n.verification_id||(i=!1),c.verification_id==n.verification_id){i=!1;break}}if(i){var s=[n].concat(r).filter((function(e,t){return t<100}));return e[t]=s,window[t]=s,G({},e)}return e},fe=function(e){try{return JSON.parse(e)}catch(t){console.error("@@@cant parse json",e)}},pe={apiKey:null,buildId:null,devBar:{slug:null},sessionData:null,metaData:null,metaConfig:{showToolbar:!0,showQuickMenu:!1,showDevBar:!0,showOverlay:!0,notifications:{showCommands:!0,showCallbacks:!0,placement:"topStart"},videoUrl:null,issuesUrl:null}},ve=function(e,t){var n=t.type,r=t.payload;return"UPDATE"===n?G({},e,r):"UPDATE_DEVBAR"===n?(e.devBar=G({},e.devBar,r),G({},e)):"UPDATE_METACONFIG"===n?(e.metaConfig=G({},e.metaConfig,r),G({},e)):"UPDATE_NOTIFICATION_SETTINGS"===n?(e.metaConfig.notifications=G({},e.metaConfig.notifications,r),G({},e)):"UPDATE_SESSION_DATA"===n?(e.sessionData=G({},e.sessionData,r),G({},e)):e},he=new(function(){function e(){this.isDev=!1,this.version="3.3.6",this.systemName="MetaEditor",this.websiteUrl="https://metaeditor.io",this.apiUrl="https://api.metaeditor.io",this.portalUrl="https://portal.metaeditor.io",this.updateUrl="https://metaeditor.io/docs/pixel-streaming/settings/update"}return W(e,[{key:"portal",get:function(){return{name:o(this.portalUrl,!0).hostname,url:this.portalUrl,urlProjects:this.portalUrl+"/user/projects/"}}}]),e}()),ge=new(function(){function e(){}var t=e.prototype;return t.urlBuilder=function(e){return he.apiUrl+"/api"+e},t.request=function(){var e=q(F().mark((function e(t,n,r){var o,i;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r={}),n=this.urlBuilder(n),(o=G({method:t,mode:"cors"},r)).headers=new Headers(G({},o.headers,{Origin:"",Accept:"application/json","Content-Type":"application/json"})),"POST"===t&&o.body)try{o.body=JSON.stringify(o.body)}catch(e){console.error("Request",{method:t,err:e})}return e.prev=5,e.next=8,fetch(n,o);case 8:return i=e.sent,e.next=11,i.json();case 11:return e.abrupt("return",{ok:200===i.status,status:i.status,body:e.sent});case 15:return e.prev=15,e.t0=e.catch(5),console.error("Request",{error:e.t0}),e.abrupt("return",{status:0,error:e.t0});case 19:case"end":return e.stop()}}),e,this,[[5,15]])})));return function(t,n,r){return e.apply(this,arguments)}}(),t.GET=function(){var e=q(F().mark((function e(t,n){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("GET",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.POST=function(){var e=q(F().mark((function e(t,n,r){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("POST",t,G({body:n},r));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.DELETE=function(){var e=q(F().mark((function e(t,n){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("DELETE",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}()),ye=function(){return new(function(){function e(){}var t=e.prototype;return t.sessionRead=function(e){return ge.GET("/streams_provider/session/read/"+e)},t.sessionCreate=function(e){return ge.POST("/streams_provider/session/create/",{build_id:e})},t.getMetaeditorData=function(e){return ge.GET("/info/metaeditor/",{headers:{"x-metaeditor-apikey":e}})},e}())},Ee=function(e,n,r){void 0===r&&(r=document);var o=t.useRef();t.useEffect((function(){o.current=n}),[n]),t.useEffect((function(){if(r&&r.addEventListener){var t=function(e){return o.current(e)};return r.addEventListener(e,t),function(){r.removeEventListener(e,t)}}}),[e,r])},we=function(){var e=function(e){return(null!=e?e:"session")+"Storage"},t="undefined"!=typeof window,n=function(n,r){var o=window[e(r)][n];try{o=JSON.parse(o)}catch(e){}return t?o:""},r=function(n,r,o){if(t){if("object"==typeof r)try{r=JSON.stringify(r)}catch(e){console.error("Can't serialize data",e)}return window[e(o)].setItem(n,r),!0}return!1},o=function(t,n){window[e(n)].removeItem(t)};return{getItem:n,setItem:r,removeItem:o,wrapper:function(e,t){return{read:(i=q(F().mark((function r(o){var i;return F().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n(e,t);case 2:if(i=r.sent,"function"!=typeof o){r.next=6;break}return o(i||null),r.abrupt("return",i);case 6:case"end":return r.stop()}}),r)}))),function(e){return i.apply(this,arguments)}),save:function(n){r(e,n,t)},remove:function(){o(e,t)}};var i}}},be=function(){var e=we();return new(function(){function t(){}return W(t,[{key:"apiKey",get:function(){return e.wrapper("API_KEY","local")}},{key:"sessionUuid",get:function(){return e.wrapper("SESSION_UUID","session")}}]),t}())},Ce=function(){return function(e){return function(e,t){var n=function(e){return e.match(/\d+/g).join(".")},r=function(e,t){if(e===t)return 0;for(var n=e.split("."),r=t.split("."),o=Math.min(n.length,r.length),i=0;i<o;i++){if(parseInt(n[i])>parseInt(r[i]))return 1;if(parseInt(n[i])<parseInt(r[i]))return-1}return n.length>r.length?1:n.length<r.length?-1:0}(e=n(e),t=n(t));return{current:e,release:t,status:r,update:r<0}}(he.version,e)}},Se=t.createContext({}),ke=function(){return t.useContext(Se)},xe=function(e){var n=function(){var e,n,o=function(){var e=t.useReducer(ve,pe),n=e[1];return[e[0],new(function(){function e(){}var t=e.prototype;return t.update=function(e){n({type:"UPDATE",payload:e})},t.updateDevBar=function(e){n({type:"UPDATE_DEVBAR",payload:e})},t.updateMetaConfig=function(e){n({type:"UPDATE_METACONFIG",payload:e})},t.updateNotificationSettings=function(e){n({type:"UPDATE_NOTIFICATION_SETTINGS",payload:e})},t.updateSessionData=function(e){n({type:"UPDATE_SESSION_DATA",payload:e})},e}())]}(),i=o[0],s=o[1],l=ye(),u=(e=t.useRef(null),n=t.useRef(null),new(function(){function r(){}var o=r.prototype;return o.restricted=function(e){return!["browser","ue"].includes(null==e?void 0:e.initiator)},o.getValue=function(e){try{return JSON.parse(e)}catch(t){console.error("@@@Cant parse event",{detail:e})}},o.pushCommand=function(n,r){var o=this.getValue(r.detail);if(!this.restricted(o)){var i=t.createElement(a,{type:void 0,header:null==o?void 0:o.command,closable:!0});e.current=c.push(i,{placement:n})}},o.pushCallback=function(e,r){var o=this.getValue(r.detail);if(!this.restricted(o)){var i=t.createElement(a,{type:"success",header:null==o?void 0:o.command,closable:!0});n.current=c.push(i,{placement:e})}},r}())),d=be(),m=Ce(),f=function(e){var n=ye(),o=be(),i=t.useRef(null),a=t.useState(!1),c=a[0],s=a[1],l=t.useState(!1),u=l[0],d=l[1];t.useEffect((function(){return function(){clearInterval(i.current)}}),[]),t.useEffect((function(){u&&(clearInterval(i.current),m.readSessionData(),i.current=setInterval(q(F().mark((function e(){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.readSessionData();case 2:case"end":return e.stop()}}),e)}))),3e3))}),[u]);var m=new(function(){function t(){}var a=t.prototype;return a.start=function(){var e=q(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(t),this.urlSessionExist){e.next=4;break}return e.next=4,this.waitSessionData(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.waitSessionData=function(){var e=q(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.sessionUuid.read((function(e){e&&d(e)})),e.next=3,n.sessionCreate(t).then(function(){var e=q(F().mark((function e(t){var n;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ok&&(n=t.body.uuid)&&(d(n),o.sessionUuid.save(n)),e.abrupt("return",!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw new Error(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.removeSession=function(){r.Logger.infoLog("Remove session & reinit"),d(!1),o.sessionUuid.remove(),clearInterval(i.current),this.waitSessionData(c)},a.readSessionData=function(){var t=q(F().mark((function t(){var r=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.sessionRead(u).then((function(t){if(t.ok){var n,o=t.body.stream_data.status,a=t.body,c=null==(n=a.metadata)?void 0:n.api_key;c&&e.update({apiKey:c}),e.updateSessionData(a),"active"===o&&clearInterval(i.current)}else r.removeSession()})).catch((function(e){throw new Error(e)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W(t,[{key:"urlSessionExist",get:function(){var e=decodeURI(window.location.search).replace("?","").split("&").map((function(e){return e.split("=")})).reduce((function(e,t){return e[t[0]]=t[1],e}),{});return!(null==e||!e.session||(d(e.session),o.sessionUuid.save(e.session),0))}}]),t}());return m}(s);Ee(ie.commands.key,(function(e){g.showCommands&&u.pushCommand(g.placementValue,e)})),Ee(ie.callbacks.key,(function(e){g.showCallbacks&&u.pushCallback(g.placementValue,e)})),t.useEffect((function(){d.apiKey.read((function(e){e&&p.loadData(e)}))}),[]),t.useEffect((function(){i.apiKey&&p.loadData()}),[i.apiKey]);var p=new(function(){function e(){}var t=e.prototype;return t.initMetaConfig=function(e){s.updateMetaConfig(e)},t.setApiKey=function(e){s.update({apiKey:e})},t.loadData=function(){var e=q(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=i.apiKey),e.next=3,l.getMetaeditorData(t).then((function(e){return e.ok?(s.update({metaData:e.body}),d.apiKey.save(t),!0):(s.update({apiKey:null}),d.apiKey.remove(),!1)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.connectBuild=function(e){s.update({buildId:e}),f.start(e)},W(e,[{key:"apiKeyIsCorrect",get:function(){return!!i.apiKey}},{key:"commands_system",get:function(){var e,t=null==(e=i.metaData)?void 0:e.commands_system;return Array.isArray(t)?t:[]}},{key:"commands_project",get:function(){var e,t=null==(e=i.metaData)?void 0:e.commands_project;return Array.isArray(t)?t:[]}},{key:"streamingUrl",get:function(){return!!this.sessionData&&this.sessionData.streamingUrl}},{key:"sharedUrl",get:function(){var e;if(!this.sessionData)return!1;var t=null==(e=this.sessionData)?void 0:e.uuid,n=document.location;return n.protocol+"//"+n.host+n.pathname+"?session="+t}},{key:"sessionData",get:function(){if(i.sessionData){var e=i.sessionData,t=e.stream_data;return{uuid:e.uuid,streamingUrl:t.host,status:t.status,secondsToStart:t.seconds_to_start}}return!1}},{key:"apiData",get:function(){if(i.sessionData){var e,t=null==(e=i.metaData)?void 0:e.api_data;return{error:t.error,module:m(t.module_version)}}return!1}}]),e}()),v=new(function(){function e(){}return W(e,[{key:"exist",get:function(){return!!i.metaData}},{key:"name",get:function(){var e,t,n;return null==(e=i.metaData)||null==(t=e.project)||null==(n=t.info)?void 0:n.name}},{key:"menu",get:function(){var e;return(null==(e=i.metaData)?void 0:e.menu)||[]}},{key:"config",get:function(){var e,t,n;return(null==(e=i.metaData)||null==(t=e.project)||null==(n=t.info)?void 0:n.config)||!1}}]),e}()),h=new(function(){function e(){}return W(e,[{key:"showToolbar",get:function(){return i.metaConfig.showToolbar}},{key:"showQuickMenu",get:function(){return i.metaConfig.showQuickMenu}},{key:"showDevBar",get:function(){return i.metaConfig.showDevBar}},{key:"helpers",get:function(){return{keyboard:i.metaConfig.helpers.keyboard}}},{key:"showOverlay",get:function(){return i.metaConfig.showOverlay}},{key:"issuesUrl",get:function(){return i.metaConfig.issuesUrl}},{key:"videoUrl",get:function(){var e,t;return(null==(e=i.sessionData)||null==(t=e.metadata)?void 0:t.video_url)||i.metaConfig.videoUrl}}]),e}()),g=new(function(){function e(){}var t=e.prototype;return t.updatePlacement=function(e){s.updateNotificationSettings({placement:e})},t.updateCommands=function(e){s.updateNotificationSettings({showCommands:e})},t.updateCallbacks=function(e){s.updateNotificationSettings({showCallbacks:e})},W(e,[{key:"showCommands",get:function(){return i.metaConfig.notifications.showCommands}},{key:"showCallbacks",get:function(){return i.metaConfig.notifications.showCallbacks}},{key:"placementsList",get:function(){return[{label:"topStart",value:"topStart"},{label:"topCenter",value:"topCenter"},{label:"topEnd",value:"topEnd"},{label:"bottomStart",value:"bottomStart"},{label:"bottomCenter",value:"bottomCenter"},{label:"bottomEnd",value:"bottomEnd"}]}},{key:"placementValue",get:function(){return i.metaConfig.notifications.placement}}]),e}());return{state:i,dispatch:s,cls:p,config:h,project:v,notifications:g}}();return t.createElement(Se.Provider,{value:n},e.children)},Te=function(){var e=t.useRef(null),n=t.useState({active:!1,percent:0,leftSeconds:0}),r=n[0],o=n[1];t.useEffect((function(){return function(){a.stop()}}),[]);var a=new(function(){function t(){}var n=t.prototype;return n.stop=function(){o({active:!1,percent:0,leftSeconds:0}),clearInterval(e.current)},n.start=function(t){if(!("number"!=typeof t||t<0||r.active)){var n=i().add(t,"seconds");clearInterval(e.current),e.current=setInterval((function(){var r,a=t,c=i.duration(n.diff(i())).asSeconds(),s=(r=a,Math.round((r-c)/r*100));if(s>=100)return clearInterval(e.current),void o({active:!1,percent:100,leftSeconds:0});o({active:!0,percent:s,leftSeconds:c})}),100)}},W(t,[{key:"active",get:function(){return r.active}},{key:"percent",get:function(){return r.percent}},{key:"leftSeconds",get:function(){return r.leftSeconds}},{key:"time",get:function(){return i.utc(1e3*r.leftSeconds).format("mm:ss")}}]),t}());return a},Ie=t.createContext({}),Le=function(){return t.useContext(Ie)},Ne=function(e){var n=function(){var e,n=ke(),r=function(){var e=t.useReducer(le,se),n=e[0],r=e[1],o=t.useCallback((function(e){var t=fe(e.detail);r({type:"COMMANDS_LIST",payload:t})}),[n]),i=t.useCallback((function(e){var t=fe(e.detail);l.commandConfirmation(null==t?void 0:t.verification_id),r({type:"CALLBACKS_LIST",payload:t})}),[n]),a=t.useCallback((function(e){r({type:"MOUSE_EVENT",payload:e.detail})}),[n]),c=t.useCallback((function(e){l.updateWebrtcData(e.detail)}),[n]),s=t.useCallback((function(e){r({type:"UPDATE_UE_SETTINGS_INITIAL",payload:e.detail})}),[r]),l=new(function(){function e(){}var t=e.prototype;return t.update=function(e){r({type:"UPDATE",payload:e})},t.updateConfig=function(e){r({type:"UPDATE_CONFIG",payload:e})},t.updatePsConfig=function(e){r({type:"UPDATE_PS_CONFIG",payload:e})},t.updateUeSettingsOnStart=function(e){r({type:"UPDATE_UE_SETTINGS_ONSTART",payload:e})},t.updatePlayerSettings=function(e){r({type:"UPDATE_PLAYER_SETTINGS",payload:e})},t.commandConfirmation=function(e){r({type:"COMMAND_CONFIRMATION",payload:e})},t.updateWebrtcData=function(e){r({type:"WEBRTC_STATUS",payload:e})},e}());return[n,l,{eventCommand:o,eventCallbacks:i,eventMouse:a,eventWebrtcStatus:c,eventUeSettingsInitial:s}]}(),o=r[0],i=r[1],a=r[2],c=t.useState(!1),s=c[0],l=c[1],u=t.useRef(null);Ee(ie.mouseAction.key,(function(e){return a.eventMouse(e)})),Ee(ie.commands.key,(function(e){return a.eventCommand(e)})),Ee(ie.callbacks.key,(function(e){return a.eventCallbacks(e)})),Ee(ie.webrtcStatus.key,(function(e){return a.eventWebrtcStatus(e)})),Ee(ie.ueInitialSettings.key,(function(e){return a.eventUeSettingsInitial(e)}));var d=function(e){var n=t.useRef(e);t.useEffect((function(){n.current=e}),[e]);var r=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current.apply(n,t)};t.useEffect((function(){return function(){o.deactivate()}}),[]);var o=new(function(){function e(){}var t=e.prototype;return t.activate=function(){window.addEventListener("beforeunload",r)},t.deactivate=function(){window.removeEventListener("beforeunload",r)},e}());return o}((function(e){e.preventDefault(),e.returnValue=""})),m=new(function(){function e(){}return W(e,[{key:"streaming",get:function(){var e=o.webrtcData.status,t=ie.webrtcStatusList,n=function(t){return t===e},r={empty:null===e,initializing:n(t.initializing),initialized:n(t.initialized),active:n(t.active),activation:n(t.activation),disconnected:n(t.disconnected),stopped:n(t.stopped),error:n(t.error),autoplaySupport:o.webrtcData.autoplaySupport,status:e||"pending"};return r._inProgress=r.empty||r.activation||r.disconnected,r._allowPlay=(r.initialized||r.stopped)&&!0!==r.autoplaySupport||r.stopped,r._playError=r.disconnected||r.error,r._allowOverlay=!r.active,r._isPending="pending"===r.status,r}},{key:"mouse",get:function(){return{moving:o.mouseEvent.moving}}}]),e}());!function(e,n){t.useEffect((function(){var t;if(n&&ce.client){var r=null==(t=e.ueSettings)?void 0:t.onStart,o=r.Encoder,i=r.WebRTC,a=r.Console;if(o&&ce.client.sendEncoderSettings(o),i&&ce.client.sendWebRtcSettings(i),a){var c=function(e){return ce.emitConsole(e)};"boolean"==typeof(null==a?void 0:a.cursor)&&c("PixelStreaming.HideCursor "+a.cursor.toString()),"boolean"==typeof(null==a?void 0:a.hudSats)&&c("PixelStreaming.HudStats "+a.hudSats.toString())}}}),[n])}(o,m.streaming.active);var f=function(e){var n=t.useRef(null),r=t.useState({width:0,height:0})[1],o=function(){var e=window.innerWidth,t=window.innerHeight;r({width:e,height:t});var n=document.documentElement;n.style.setProperty("--window-width",window.innerWidth+"px"),n.style.setProperty("--window-height",window.innerHeight+"px"),n.style.setProperty("--player-object-fit",e>t?"unset":"fill"),i.updateWebrtcResolution(e,t)};Ee("resize",o,window);var i=new(function(){function t(){}var r=t.prototype;return r.resize=function(){o()},r.updateWebrtcResolution=function(){var t=q(F().mark((function t(r,o){var i,a;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:clearTimeout(n.current),i=function(e){return ce.emitConsole(e)},a=function(e,t){return ce.emitCommandSystem(e,t)},n.current=setTimeout((function(){var t=ce.client;if(e)switch("boolean"==typeof e.cursor&&i("PixelStreaming.HudStats "+e.cursor.toString()),"boolean"==typeof e.hudSats&&i("PixelStreaming.HudStats "+e.hudSats.toString()),e.mode){case"command":a("resolution_change",{width:r,height:o});break;case"console":t&&t.ueDescriptorUi.sendUpdateVideoStreamSize(r,o)}}),500);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),t}());return i}(null==(e=o.ueSettings.onStart)?void 0:e.Console);t.useEffect((function(){ce.client&&m.streaming.error&&o.config.autoRestart&&(console.error("@@@restarting..."),h.streamingConnect())}),[m.streaming.error]);var p=Te();t.useEffect((function(){if(m.streaming.empty){var e=o.config.secondsToStart;"number"==typeof e&&e>0&&p.start(e)}m.streaming.initialized&&p.stop()}),[m.streaming.initialized,o.config.secondsToStart]),function(e,n,r){var o=Math.round(r.secondsToKill),i=t.useRef(null),a=t.useRef(null),c=t.useRef(0);t.useEffect((function(){return function(){s()}}),[]);var s=function(){clearTimeout(a.current),clearTimeout(i.current),e.updateConfig({secondsToKillLeft:null})};t.useEffect((function(){"number"!=typeof o||o<=0||(n?"number"==typeof o&&o>0&&(clearTimeout(i.current),clearInterval(a.current),c.current=Math.round(o),a.current=setInterval((function(){c.current-=1,e.updateConfig({secondsToKillLeft:c.current})}),1e3),i.current=setTimeout((function(){clearInterval(a.current),oe.verboseLog("Connection killed"),ce.close()}),1e3*o)):s())}),[r.secondsToKill,n])}(i,m.streaming.active,o.config),t.useEffect((function(){m.streaming.active?(d.activate(),f.resize()):d.deactivate()}),[m.streaming.active]),t.useEffect((function(){n.cls.streamingUrl&&h.initPlayer(n.cls.streamingUrl)}),[n.cls.streamingUrl]);var v=n.state.sessionData;t.useEffect((function(){if(v){var e=n.cls.sessionData.secondsToStart;"number"==typeof e&&e>0&&!o.secondsToStart&&i.updateConfig({secondsToStart:e})}}),[v]);var h=new(function(){function e(){this.initReady=s}var t=e.prototype;return t._allowCommand=function(e){if(ce.client&&m.streaming.active)return!0;console.error("@@@error, streaming not active",{command:e})},t.emitCommandSystem=function(e,t){this._allowCommand(e)&&ce.emitCommandSystem(e,t)},t.emitAsyncCommand=function(){var e=q(F().mark((function e(t,n){var r,o,i,a,c;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._allowCommand(t)){e.next=2;break}return e.abrupt("return");case 2:r=ce.emitCommand(t,n),o=50,i=F().mark((function e(t){var n,o,i;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,100,t)}));case 2:n=K(window.callbacks_list||[]);case 3:if((o=n()).done){e.next=9;break}if((null==(i=o.value)?void 0:i.verification_id)!==(null==r?void 0:r.verification_id)){e.next=7;break}return e.abrupt("return",{v:i});case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})),a=0;case 7:if(!(a<o)){e.next=15;break}return e.delegateYield(i(a),"t0",9);case 9:if("object"!=typeof(c=e.t0)){e.next=12;break}return e.abrupt("return",c.v);case 12:a++,e.next=7;break;case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.emitUuidAsync=function(){var e=q(F().mark((function e(t){var r,o,i;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=K(n.cls.commands_project);case 1:if((o=r()).done){e.next=9;break}if((i=o.value).command_uuid!==t){e.next=7;break}return e.next=6,this.emitAsyncCommand(i.command,i.value);case 6:return e.abrupt("return",e.sent);case 7:e.next=1;break;case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.initConfig=function(e,t,n){i.updateConfig(e),i.updatePsConfig(t),i.updateUeSettingsOnStart(n),clearTimeout(u.current),u.current=setTimeout((function(){l(!0)}),300)},t.initPlayer=function(e){e?(i.updateConfig({streamingUrl:e}),i.updateWebrtcData({status:"initializing"}),new ae(e,o.psConfig).init()):console.error("Missing data:",{streamingUrl:e})},t.streamingConnect=function(){ce.connect()},t.streamingStop=function(){ce.close()},t.switchStart=function(){m.streaming.active?this.streamingStop():this.streamingConnect()},t.clientCb=function(e){var t=ce.client;t&&e(t)},t.changeVolume=function(e){void 0===e&&(e=1),this.clientCb((function(t){t.videoPlayerController.audioElement?(e>0?t.videoPlayerController.audioElement.play():0===e&&t.videoPlayerController.audioElement.pause(),t.videoPlayerController.audioElement.volume=e):(t.videoPlayerController.PlayAudioTrack(),e=1)})),i.updatePlayerSettings({volume:e})},W(e,[{key:"info",get:function(){return{loading:p}}},{key:"methods",get:function(){return{commands:{clear:function(){return i.update({commands_list:[]})}},callbacks:{clear:function(){return i.update({callbacks_list:[]})}}}}}]),e}());return{state:o,cls:h,computed:m,dispatch:i}}();return t.createElement(Ie.Provider,{value:n},e.children)},De=new(function(){function e(){this.getMax=function(e){return"@media (max-width: "+e+"px)"},this.getMin=function(e){return"@media (min-width: "+e+"px)"},this.sizes={xs:0,sm:600,md:900,lg:1200,xl:1536}}return W(e,[{key:"down",get:function(){return{xs:this.getMax(this.sizes.sm),sm:this.getMax(this.sizes.md),md:this.getMax(this.sizes.lg),lg:this.getMax(this.sizes.xl)}}},{key:"up",get:function(){return{xs:this.getMin(this.sizes.xs),sm:this.getMin(this.sizes.sm),md:this.getMin(this.sizes.md),lg:this.getMin(this.sizes.lg),xl:this.getMin(this.sizes.xl)}}}]),e}()),Ae=function(e){var n,r=Le(),o=e.isFirst,i=!o;return o&&"pixelStreaming"===(null==(n=r.state.devBar)?void 0:n.slug)?t.createElement("div",null):t.createElement("div",{id:"playerUI",onWheel:function(e){return e.stopPropagation()},style:{display:!0===i?"block":"none"}},t.createElement("div",{id:"overlay",className:"overlay"},t.createElement("div",{id:"overlayHeader"},t.createElement("div",{id:"qualityStatus",className:"greyStatus"},"***"),t.createElement("div",{id:"overlayButton"},"+")),t.createElement("div",{id:"overlaySettings",className:"container d-none"},t.createElement("div",{id:"Controls",className:"row"},t.createElement("section",{id:"preStreamOptions",className:"settingsContainer"},t.createElement("div",{id:"preStreamOptionsHeader",className:"settings-text"},t.createElement("div",null,"Pre Stream Options")),t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"force-turn-tgl"},"Force TURN")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"force-turn-tgl"}))),t.createElement("div",{className:"row",style:{paddingTop:5,paddingBottom:5}},t.createElement("div",{className:"col col-auto"},t.createElement("input",{id:"restart-stream-button",className:"overlay-button btn-flat",type:"button",defaultValue:"Restart Stream"})))),t.createElement("section",{id:"viewSettings",className:"settingsContainer"},t.createElement("div",{id:"viewSettingsHeader",className:"settings-text"},t.createElement("div",null,"Viewing")),t.createElement("div",{id:"viewSettingsContainer",className:"d-none"},t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"enlarge-display-to-fill-window-tgl"},"Enlarge display to fill window")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"enlarge-display-to-fill-window-tgl",defaultChecked:!0}))),t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"quality-control-ownership-tgl"},"Is Quality Controller")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"quality-control-ownership-tgl"}))),t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"match-viewport-res-tgl"},"Match viewport resolution")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"match-viewport-res-tgl"}))),t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"control-scheme-tgl",id:"control-scheme-title"},"Match viewport resolution")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"control-scheme-tgl"}))))),t.createElement("section",{id:"commands",className:"settingsContainer"},t.createElement("div",{id:"commandsHeader",className:"settings-text"},t.createElement("div",null,"Commands")),t.createElement("div",{id:"commandsContainer",className:"d-none"},t.createElement("div",{className:"row",style:{paddingTop:5,paddingBottom:5}},t.createElement("div",{className:"row",style:{paddingTop:5,paddingBottom:5}},t.createElement("div",{className:"col col-auto"},t.createElement("input",{id:"show-fps-button",className:"overlay-button btn-flat",type:"button",defaultValue:"Show FPS"}))),t.createElement("div",{className:"col col-auto"},t.createElement("label",{htmlFor:"ui-descriptor-text",className:"settings-text"},"UI Descriptor")),t.createElement("div",{className:"col col-auto"},t.createElement("input",{type:"text",className:"form-control form-control-sm",id:"ui-descriptor-text"})),t.createElement("div",{className:"col col-auto"},t.createElement("input",{type:"button",id:"sendUiDescriptor",className:"overlay-button btn-flat",defaultValue:"Send"}))))),t.createElement("section",{id:"streamingSettings",className:"settingsContainer"},t.createElement("div",{id:"streamingSettingsHeader",className:"settings-text"},t.createElement("div",null,"Settings")),t.createElement("div",{id:"streamingSettingsContainer",className:"d-none"},t.createElement("div",{className:"form-group row"},t.createElement("div",{className:"col-sm"},t.createElement("div",null,"Encoder Settings"),t.createElement("div",{id:"encoderSettings",className:"col"},t.createElement("div",{className:"form-group row"},t.createElement("label",{htmlFor:"encoder-min-qp-text"},"Min QP"),t.createElement("input",{type:"number",className:"form-control form-control-sm",id:"encoder-min-qp-text",defaultValue:"0",min:"0",max:"51"})),t.createElement("div",{className:"form-group row"},t.createElement("label",{htmlFor:"encoder-max-qp-text"},"Max QP"),t.createElement("input",{type:"number",className:"form-control form-control-sm",id:"encoder-max-qp-text",defaultValue:"51",min:"0",max:"51"})))),t.createElement("div",{className:"col-sm"},t.createElement("div",null,"WebRTC Settings"),t.createElement("div",{id:"webrtcSettings"},t.createElement("div",{className:"form-group row"},t.createElement("label",{htmlFor:"webrtc-fps-text"},"FPS"),t.createElement("input",{type:"number",className:"form-control form-control-sm",id:"webrtc-fps-text",defaultValue:"0",min:"1",max:"999"})),t.createElement("div",{className:"form-group row"},t.createElement("label",{htmlFor:"webrtc-min-bitrate-text"},"Min bitrate (bps)"),t.createElement("input",{type:"number",className:"form-control form-control-sm",id:"webrtc-min-bitrate-text",defaultValue:"0",min:"0",max:"100000"})),t.createElement("div",{className:"form-group row"},t.createElement("label",{htmlFor:"webrtc-max-bitrate-text"},"Max bitrate (bps)"),t.createElement("input",{type:"number",className:"form-control form-control-sm",id:"webrtc-max-bitrate-text",defaultValue:"0",min:"0",max:"100000"}))))),t.createElement("div",{className:"form-group row"},t.createElement("input",{id:"btn-streaming-settings",className:"overlay-button btn-flat",type:"button",defaultValue:"Apply"})))),t.createElement("section",{id:"statistics",className:"settingsContainer"},t.createElement("div",{id:"statisticsHeader",className:"settings-text"},t.createElement("div",null,"Statistics")),t.createElement("div",{id:"statisticsContainer",className:"d-none"},t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm"},t.createElement("label",{className:"form-check-label",htmlFor:"send-stats-tgl",id:"control-scheme-title"},"Send to server")),t.createElement("div",{className:"form-check form-switch col-auto"},t.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"send-stats-tgl"}))),t.createElement("div",{id:"statisticsResult",className:"StatsResult"}))),t.createElement("section",{id:"latencyTest",className:"settingsContainer"},t.createElement("div",{id:"latencyTestHeader",className:"settings-text"},t.createElement("div",null,"Latency Test"),t.createElement("input",{id:"btn-start-latency-test",className:"overlay-button btn-flat",type:"button",defaultValue:"Run Test"})),t.createElement("div",{id:"latencyTestContainer",className:"d-none"},t.createElement("div",{id:"latencyStatsResults",className:"StatsResult"})))))))},Me=s.createUseStyles({header:(ue={},ue[De.down.xs]={marginTop:40},ue),container:{overflow:"auto",pointerEvents:"all",maxHeight:"calc(100vh - 77px)"}}),Pe=t.forwardRef((function(e,n){var r=Me(),o=t.useState(!1),i=o[0],a=o[1],c=t.useState({body:e.withBody,title:e.title,Component:null}),s=c[0],l=c[1];t.useImperativeHandle(n,(function(){return{open:function(e,t,n){void 0===n&&(n=null),l((function(r){return G({},r,{title:e||r.title,body:t||r.body,Component:n||null})})),a(!0)},close:function(){d()},isOpen:i}}));var u,d=function(){a(!1),"function"==typeof e.onClose&&e.onClose()};return t.createElement(m,{size:"xs",placement:"right",backdrop:!1,open:i,onClose:d},t.createElement(m.Header,{className:r.header},"string"==typeof s.title?t.createElement(m.Title,null,s.title):s.title,e.ActionsComponent?t.createElement(m.Actions,{style:{marginRight:-20}},e.ActionsComponent):""),t.createElement("div",{onWheel:function(e){e.stopPropagation()},className:r.container},(u=s.Component||e.children,s.body?t.createElement("div",{style:{padding:20}},u):u)))})),Re=function(e){return t.createElement(w,{style:{backgroundColor:"transparent"},theme:"monokai",quotesOnKeys:!1,groupArraysAfterLength:2,collapseStringsAfterLength:10,displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,src:e.data})},Be=function(){var e,n=Le();return t.createElement("div",null,t.createElement(Re,{data:(e=n.state,delete e.callbacks_list,delete e.commands_list,e)}))},Oe=function(){var e=ke();return t.createElement("div",null,t.createElement(Re,{data:e.state}))},Ue=s.createUseStyles({groupList:{listStyle:"none",margin:0,padding:0,marginBottom:10,paddingBottom:10,borderBottom:"solid 1px rgba(255,255,255,.1)","& > li":{"&:nth-child(1)":{opacity:.7,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,marginBottom:10},"&:nth-child(2)":{display:"flex",flexWrap:"wrap",gap:5}}}}),ze=function(e){var n=Ue(),r=Le(),o=ke(),i=t.useState({}),a=i[0],c=i[1];t.useEffect((function(){o.cls.loadData()}),[]);var s=function(e,t){c((function(n){var r;return G({},n,((r={})[e]=t,r))}))},l=function(){var e=q(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(t.id,"loading"),e.next=3,r.cls.emitAsyncCommand(t.slug,t.value).then((function(e){s(t.id,e?"success":"error")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.createElement("div",null,function(){var r={};e.list.map((function(e){var t;void 0===r[e.slug]&&(r[e.slug]={name:e.slug,group:null==(t=e.group)?void 0:t.name,items:[]}),r[e.slug].items.push(e)}));var o=Object.values(r);return t.createElement("div",null,o.map((function(e,r){return t.createElement("ul",{key:r,className:n.groupList},t.createElement("li",null,e.name," (",e.group,")"),t.createElement("li",null,e.items.map((function(e,n){var o=!1;return a.hasOwnProperty(e.id)&&(o=a[e.id]),t.createElement("div",{key:r+"-"+n},t.createElement(u,{onClick:function(){return l(e)},loading:"loading"===o,icon:t.createElement(b,{style:{zIndex:10},onClick:function(t){t.preventDefault(),t.stopPropagation(),navigator.clipboard.writeText(e.command_uuid).then((function(){alert("Uuid copied:\n"+e.command_uuid)}),(function(e){console.error("Async: Could not copy text: ",e)}))}}),placement:"left"},void 0===(null==e?void 0:e.name)?"":e.name.length>20?e.name.substr(0,17)+"...":e.name))}))))})))}())},je=function(){var e=ke();return t.createElement("div",null,t.createElement(ze,{list:e.cls.commands_project}))},He=function(){var e=Le(),n=ke();return t.createElement("div",null,t.createElement(C,{block:!0,style:{marginBottom:20},onClick:function(){return e.cls.switchStart()}},"Start / stop"),t.createElement(ze,{list:n.cls.commands_system}))},Fe=function(){var e,n=Le();return t.createElement("div",null,t.createElement(C,{style:{marginBottom:10},block:!0,onClick:function(){return n.cls.methods.commands.clear()}},"Clear"),t.createElement(Re,{data:null==(e=n.state)?void 0:e.commands_list}))},Qe=function(){var e,n=Le();return t.createElement("div",null,t.createElement(C,{style:{marginBottom:10},block:!0,onClick:function(){return n.cls.methods.callbacks.clear()}},"Clear"),t.createElement(Re,{data:null==(e=n.state)?void 0:e.callbacks_list}))},qe=function(){var e=ke(),n=t.useState({type:"info",header:"Some title"}),r=n[0],o=n[1],i=t.createElement(a,{type:r.type,header:r.header,closable:!0});return t.createElement("div",null,i,t.createElement(x,null,t.createElement(T,{value:r.type,data:[{label:"Test command",value:"info"},{label:"Test callback",value:"success"}],onChange:function(e,t){o({type:e,header:t.target.innerText})}}),t.createElement(T,{defaultValue:e.notifications.placementValue,data:e.notifications.placementsList,onChange:function(t){e.notifications.updatePlacement(t)}}),t.createElement(C,{onClick:function(){return c.push(i,{placement:e.notifications.placementValue})}},"Push")),t.createElement(x,null,t.createElement(C,{onClick:function(){return c.remove("")}},"Remove"),t.createElement(C,{onClick:function(){return c.clear()}},"Clear")))},_e=function(){var e=ke();return t.createElement("div",null,t.createElement(S.Group,null,t.createElement(S.ControlLabel,null,"System Notifications"),t.createElement("div",{style:{display:"flex",gap:5,paddingTop:10}},t.createElement(k,{checked:e.notifications.showCommands,onChange:function(t){return e.notifications.updateCommands(t)},size:"lg",checkedChildren:"Commands: on",unCheckedChildren:"Commands: off"}),t.createElement(k,{checked:e.notifications.showCallbacks,onChange:function(t){return e.notifications.updateCallbacks(t)},size:"lg",checkedChildren:"Callbacks: on",unCheckedChildren:"Callbacks: off"}))),t.createElement("div",{style:{paddingTop:20}},t.createElement(qe,null)))},We=function(){return t.createElement("div",null,t.createElement(Ae,null))},Ge=function(e){var n=t.useRef(null),r=ke(),o=[["Player Data","playerData",t.createElement(v,null),t.createElement(Be,null)],["Meta Data","metaData",t.createElement(v,null),t.createElement(Oe,null)],["Menu: system","menuSystem",t.createElement(E,null),t.createElement(He,null)],["Menu: project","menuProject",t.createElement(E,null),t.createElement(je,null)],["History: commands","historyCommands",t.createElement(h,null),t.createElement(Fe,null)],["History: callbacks","historyCallbacks",t.createElement(h,null),t.createElement(Qe,null)],["Settings","settings",t.createElement(g,null),t.createElement(_e,null)],["Pixel Streaming","pixelStreaming",t.createElement(y,null),t.createElement(We,null)]].map((function(e){return{label:e[0],slug:e[1],Icon:e[2],Component:e[3]}}));return t.createElement("div",null,t.createElement(Pe,{onClose:function(){return e.onClose()},ref:n}),t.createElement(f,{defaultOpenKeys:["3","4"]},t.createElement(f.Body,null,t.createElement(p,null,o.map((function(e,o){return t.createElement(p.Item,{key:o,icon:t.createElement(t.Fragment,null,e.Icon),eventKey:o.toString(),children:e.label,onClick:function(){!function(e){r.dispatch.updateDevBar({slug:e.slug}),n.current.open(e.label,!0,e.Component)}(e)}})}))))),t.createElement(t.Fragment,null))},Ve=t.forwardRef((function(e,n){var r=t.useState(!1),o=r[0],i=r[1];t.useImperativeHandle(n,(function(){return{open:function(){i(!0)},close:function(){a()},isOpen:o}}));var a=function(){i(!1),"function"==typeof e.onClose&&e.onClose()},c=!1!==e.FooterComponent;return t.createElement(N,{open:o,onClose:a},t.createElement(N.Header,null,t.createElement(N.Title,null,e.title)),t.createElement(N.Body,null,e.children),c&&t.createElement(N.Footer,null,e.FooterComponent||t.createElement(t.Fragment,null,t.createElement(C,{onClick:function(){"function"==typeof e.onSuccess&&e.onSuccess(),a()},appearance:"primary"},"Ok"),t.createElement(C,{onClick:a,appearance:"subtle"},"Cancel"))))})),Ze=function(){var e,n,r=ke(),o=be(),i=t.useRef(null),a=t.useState(""),c=a[0],s=a[1],l=t.useState(!1)[1],u=t.useState(!1),d=u[0],m=u[1],f=null==(e=r.cls)||null==(n=e.apiData)?void 0:n.error;t.useEffect((function(){o.apiKey.read((function(e){e&&s(e)}))}),[]);var p=function(){i.current.open()},v=function(){var e=q(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(t.stopPropagation(),t.preventDefault()),m(!0),l(!1),e.next=5,r.cls.loadData(c);case 5:e.sent?(r.cls.setApiKey(c),i.current.close()):l("Wrong Api Key"),m(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.createElement("div",null,t.createElement(Ve,{title:"Api Connector",onSuccess:void 0,onClose:void 0,FooterComponent:t.createElement(t.Fragment,null,t.createElement(C,{onClick:function(){window.open(he.portal.urlProjects)}},"My Projects"),t.createElement(C,{disabled:d,onClick:v,appearance:"primary"},"Connect")),ref:i},t.createElement("div",null,t.createElement(L,{showIcon:!0,type:"warning",style:{marginBottom:20}},"Copy your Api Key from ",t.createElement("a",{href:he.portal.urlProjects,target:"_blank"},he.portal.name)),t.createElement("form",{onSubmit:v},t.createElement(I,{disabled:d,value:c,onChange:s,size:"lg",required:!0,placeholder:"Enter Api Key"}),f&&t.createElement("div",{style:{color:"red",marginTop:10}},f)))),r.cls.apiKeyIsCorrect?t.createElement(C,{color:"green",appearance:"ghost",onClick:p},"Reconnect Project"):t.createElement(C,{color:"red",appearance:"primary",onClick:p},"Connect Project"))},Ke=function(){var e=ke().cls.apiData.module;return null!=e&&e.update?t.createElement("div",{style:{padding:"1rem"}},t.createElement(C,{color:"red",appearance:"primary",block:!0,href:he.updateUrl,target:"_blank"},"Update MetaEditor to v",null==e?void 0:e.release)):t.createElement("div",null)},Je=s.createUseStyles({titleList:{margin:0,display:"flex",alignItems:"center","& > li:nth-child(2) > span":{marginLeft:10,padding:"3px 5px",borderRadius:4,fontSize:11,backgroundColor:"rgba(255,255,255,.3)"}}}),Xe=function(){var e=Je(),n=ke(),r=t.useRef(null),o=function(){n.dispatch.updateDevBar({slug:"drawer"})},i=function(){o(),r.current.isOpen?r.current.close():r.current.open()};return l.useHotkeys("ctrl+z",(function(e){e.repeat||i()}),[]),t.createElement("div",null,t.createElement(u,{onClick:function(){return i()},icon:t.createElement(d,null),circle:!0,size:"lg"}),t.createElement(Pe,{onClose:function(){n.dispatch.updateDevBar({slug:null})},ref:r,withBody:!1,title:t.createElement("ul",{className:e.titleList},t.createElement("li",null,t.createElement("h6",null,"MetaEditor")),t.createElement("li",null,t.createElement("span",null,"v",he.version))),ActionsComponent:t.createElement(Ze,null)},t.createElement("div",null,t.createElement(Ke,null),t.createElement(Ge,{onClose:function(){o()}}))))},Ye=s.createUseStyles({root:{transition:"opacity 700ms linear",backgroundColor:"#000",position:"fixed",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",top:0,left:0,right:0,bottom:0,zIndex:950,"& > video":{width:"100%",height:"100%",objectFit:"cover",opacity:.4,position:"absolute",overflow:"hidden",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:-1}},box:{fontSize:12,opacity:.7,display:"inline-block",cursor:"default"},reportLink:{display:"inline-block",marginTop:10,borderBottom:"solid 1px rgba(255,255,255,.3)",cursor:"pointer"}}),$e=function(){var e=Ye(),n=Le(),r=ke(),o=t.useRef(null),i=n.cls.info.loading,a=i.percent,c=i.time,s=r.config.videoUrl,l=n.computed.streaming,m=l.status,f=l._isPending,p=l._inProgress,v=l._allowPlay,h=l._allowOverlay,g=l._playError;t.useEffect((function(){o.current.style.opacity=h?1:0,o.current.style.pointerEvents=h?"all":"none"}),[h]);var E,w=function(e,n,r){return t.createElement(u,{onClick:function(t){t.preventDefault(),t.stopPropagation(),e()},circle:!0,icon:t.createElement(n,{spin:r,style:{fontSize:"5em"}})})};return t.createElement("div",{ref:o,className:e.root},s?t.createElement("video",{loop:!0,autoPlay:!0,muted:!0},t.createElement("source",{src:s,type:"video/mp4"})):"",t.createElement("div",{style:{textAlign:"center"}},t.createElement("div",{style:{margin:20}},(E={style:{width:120,cursor:"default"},percent:a,showInfo:!0},g?t.createElement(D.Circle,Object.assign({},E,{status:"fail"})):p&&a>0?t.createElement(D.Circle,Object.assign({},E,{status:"active"})):v?w((function(){return n.cls.streamingConnect()}),y,!1):w((function(){}),d,!0))),t.createElement("div",{className:e.box},t.createElement("div",{style:{textTransform:"uppercase",letterSpacing:2}},m," ",f&&a>0?c:""),r.config.issuesUrl?t.createElement("div",{onClick:function(){return window.open(r.config.issuesUrl)},className:e.reportLink},"Report a problem"):"")))},et=s.createUseStyles({root:{width:function(e){return e.size},height:function(e){return e.size},fontSize:function(e){return e.size/1.3},display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"}}),tt={name:"volumeOn",size:20},nt=function(e){void 0===e&&(e=tt);var n=e.name,r=et({size:e.size}),o={volumeOn:M.faVolumeHigh,volumeOff:M.faVolumeOff,expand:M.faExpand,qrcode:M.faQrcode,compress:M.faCompress,play:M.faPlay,pause:M.faPause,star:M.faStar,arrowLeft:M.faSquareCaretLeft,arrowRight:M.faSquareCaretRight,arrowUp:M.faSquareCaretUp,arrowDown:M.faSquareCaretDown,question:M.faQuestion},i=function(){return t.createElement("span",{className:r.root},t.createElement(A.FontAwesomeIcon,{icon:o.hasOwnProperty(n)?o[n]:t.createElement(t.Fragment,null)}))};return e.button?t.createElement(u,{disabled:e.disabled,onClick:function(){"function"==typeof e.onClick&&e.onClick()},icon:i(),circle:!0,size:e.buttonSize}):i()};nt.defaultProps=tt;var rt,ot,it,at={level:"L",fgColor:"#000000",bgColor:"#FFFFFF",value:"",size:26,title:""},ct=function(e){return void 0===e&&(e=at),t.createElement("div",null,t.createElement(R,{level:e.level,bgColor:e.bgColor,fgColor:e.fgColor,size:e.size,title:e.title,value:e.value}))},st=s.createUseStyles({root:{backgroundColor:"#fff",padding:"60px 30px",display:"flex",justifyContent:"center",borderRadius:10,marginTop:30}}),lt=function(){var e=st(),n=ke(),r=Le(),o=new(function(){function e(){}return e.prototype.text=function(e){navigator.clipboard.writeText(e).then((function(){console.log("Async: Copying to clipboard was successful!"),alert("Copied!")}),(function(e){console.error("Async: Could not copy text: ",e)}))},e}()),i=t.useRef(null),a=n.cls.sharedUrl;return t.createElement("div",null,t.createElement(Ve,{title:"Quick Access",onSuccess:void 0,onClose:void 0,FooterComponent:void 0,ref:i},t.createElement("div",null,t.createElement("div",{style:{marginBottom:10}},"Copy the address or scan the QR code with your phone."),t.createElement(P,{size:"lg"},t.createElement(I,{readOnly:!0,defaultValue:a||""}),t.createElement(P.Button,{onClick:function(){return o.text(a)}},t.createElement(b,null))),t.createElement("div",{className:e.root},t.createElement(ct,{value:a})))),t.createElement(nt,{disabled:!a,button:!0,buttonSize:"lg",name:"qrcode",onClick:function(){r.cls.streamingStop(),i.current.open()}}))},ut=s.createUseStyles({popover:{width:150,padding:10}}),dt=function(){var e,n=ut(),r=Le(),o=t.useRef(null),i=!r.computed.streaming.active,a=r.state.playerSettings.volume,c="number"==typeof a&&a<=0;return t.createElement("div",null,t.createElement(O,{ref:o,placement:"left",trigger:"hover",enterable:!0,disabled:i,speaker:t.createElement(B,{title:"Volume"},t.createElement("div",{className:n.popover},t.createElement(U,{getAriaValueText:function(e){return 100*e+"%"},tooltip:!1,min:0,max:1,step:.1,value:null==(e=r.state.playerSettings)?void 0:e.volume,onChange:function(e){return r.cls.changeVolume(e)}})))},t.createElement("div",null,t.createElement(nt,{button:!0,buttonSize:"lg",name:c?"volumeOff":"volumeOn",disabled:i,onClick:function(){r.cls.changeVolume(0===a?1:0)}}))))},mt=s.createUseStyles({content:{},keysList:{marginBottom:20,width:230,fontSize:".8rem","& > li":{display:"flex",alignItems:"center",padding:"3px 0","& label":{width:100},"& > div":{display:"flex",alignItems:"center","& > span":{margin:"0 4px"}}}},button:{backgroundColor:"#fff",color:"rgba(0,0,0,.7)"}}),ft=function(){var e=mt(),n={message:new(function(){function e(){}var n=e.prototype;return n.clear=function(){c.clear()},n.push=function(e,n,r){var o=t.createElement(L,Object.assign({},n),e);c.push(o,r)},e}())},r=Le();t.useEffect((function(){r.computed.streaming.active&&setTimeout((function(){o()}),3e3)}),[r.computed.streaming.active]);var o=function(){var r;n.message.push((r=[["Move up","W","arrowUp"],["Move down","S","arrowDown"],["Move left","A","arrowLeft"],["Move left","D","arrowRight"]].map((function(e){return{label:e[0],key:e[1],icon:e[2]}})),t.createElement("div",{className:e.content},t.createElement("ul",{className:e.keysList},r.map((function(e,n){return t.createElement("li",{key:n},t.createElement("label",null,e.label),t.createElement("div",null,'Press "',e.key,'" or ',t.createElement(nt,{name:e.icon,size:20})))}))),t.createElement(C,{onClick:function(){return n.message.clear()},appearance:"primary",className:e.button},"I got it"))),{header:"HotKeys",showIcon:!1,type:"info",closable:!0,duration:1e4},{placement:"bottomEnd"})};return t.createElement(nt,{button:!0,buttonSize:"lg",name:"question",onClick:function(){o()}})},pt=function(){var e=Le(),n=function(){var e=t.useState(!1),n=e[0],r=e[1];l.useHotkeys("ctrl+f",(function(e){e.repeat||i.open()}),[]);var o=function(){document.fullscreenElement?(console.log("Element: "+document.fullscreenElement.id+" entered fullscreen mode."),r(!0)):(console.log("Leaving fullscreen mode."),r(!1))};t.useEffect((function(){return document.addEventListener("fullscreenchange",o),function(){document.removeEventListener("fullscreenchange",o)}}),[]);var i=new(function(){function e(){this.doc=document.documentElement,this.active=n}var t=e.prototype;return t.open=function(){this.doc.requestFullscreen?this.doc.requestFullscreen().then((function(){})).catch((function(e){console.error({error:e})})):this.doc.webkitRequestFullscreen?this.doc.webkitRequestFullscreen().then((function(){})).catch((function(e){console.error({error:e})})):this.doc.msRequestFullscreen&&this.doc.msRequestFullscreen().then((function(){})).catch((function(e){console.error({error:e})}))},t.close=function(){document.fullscreenElement?document.exitFullscreen().then((function(){return console.log("Document Exited from Full screen mode")})).catch((function(e){return console.error(e)})):document.documentElement.requestFullscreen()},e}());return i}(),r=e.computed.streaming,o=r.active;return t.createElement(t.Fragment,null,t.createElement(nt,{button:!0,buttonSize:"lg",name:o?"pause":"play",disabled:!r._allowPlay&&!o,onClick:function(){e.cls.switchStart()}}),t.createElement(dt,null),t.createElement(nt,{button:!0,buttonSize:"lg",name:n.active?"compress":"expand",onClick:function(){n.active?n.close():n.open()}}),t.createElement(lt,null),t.createElement(ft,null))},vt=function(){var e={xs:!1,sm:!1,md:!1,lg:!1,xl:!1},n=t.useState(e),r=n[0],o=n[1],i=function(){var t,n=window.innerWidth;o(((t={defaultSizes:e})[n>De.sizes.xl?"xl":n>De.sizes.lg?"lg":n>De.sizes.md?"md":n>De.sizes.sm?"sm":"xs"]=!0,t))};return t.useEffect((function(){return window.addEventListener("resize",(function(){return i()})),i(),function(){return window.removeEventListener("resize",(function(){return i()}))}}),[]),r},ht=["onClose","items"],gt=s.createUseStyles({root:(ot={position:"fixed",left:0,right:0,bottom:0,zIndex:1040,display:"flex",justifyContent:"center"},ot[De.up.sm]={left:10,right:10,bottom:10},ot["& > div"]=(rt={opacity:function(e){return e.isMoving?.3:1},backgroundColor:"rgba(0,0,0,.8)"},rt[De.down.sm]={width:"100%",borderTop:"solid 1px rgba(255,255,255,.1)"},rt[De.up.sm]={backdropFilter:"blur(5px)",border:"solid 1px rgba(255,255,255,.1)",borderRadius:5,transition:"opacity .5s ease-in-out",padding:"0 10px"},rt),ot),dropdownItem:{display:"flex",alignItems:"center",minWidth:150,maxWidth:200,"& > img":{width:50,borderRadius:5,marginRight:10}},mobileNavbar:{display:"flex",alignItems:"center",margin:0,padding:"0 10px",'& > [data-li="logo"]':{fontWeight:600,minWidth:100,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"15px 10px"},'& > [data-li="menu"]':{flex:1,overflowY:"auto"}},mobileMenu:{display:"flex","& > li":{padding:"15px 10px","& label":{fontSize:".8rem",textTransform:"uppercase"}}}}),yt=t.forwardRef((function(e,n){var r=e.onClose,o=e.items,i=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(e,ht),a=gt({isMoving:!1});return t.createElement(B,Object.assign({ref:n},i,{full:!0}),t.createElement(j.Menu,null,o.map((function(e,n){return t.createElement(j.Item,{key:n,onClick:function(){e.onClick(),r()}},t.createElement("div",{className:a.dropdownItem},e.preview_small?t.createElement("img",{src:e.preview_small}):"",e.name))}))))})),Et=t.forwardRef((function(e,n){var r,o=ke(),i=Le(),a=function(){var e=ke(),t=Le();return new(function(){function n(){}return n.prototype._emit=function(){var e=q(F().mark((function e(n){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cls.emitUuidAsync(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W(n,[{key:"menu",get:function(){var t=this,n=function(e){e&&t._emit(e)};return(e.project.menu||[]).map((function(e){return G({},e,{onClick:function(){return n(e.command_uuid)},subitems:e.subitems.map((function(t){return G({},t,{onClick:(r=q(F().mark((function r(){return F().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(e.command_uuid),r.next=3,n(t.command_uuid);case 3:case"end":return r.stop()}}),r)}))),function(){return r.apply(this,arguments)})});var r}))})}))}}]),n}())}(),c=vt(),s=t.useRef(),l=t.useState(null),u=l[0],d=l[1],m=!i.computed.streaming.active,f=gt({isMoving:i.computed.mouse.moving}),v=c.xs||c.sm;return t.createElement("div",{className:f.root},t.createElement("div",null,t.createElement("div",Object.assign({},e,{ref:n}),v?(r=function(){s.current.close()},t.createElement("div",null,t.createElement("ul",{className:f.mobileNavbar},t.createElement("li",{"data-li":"logo"},o.project.name),t.createElement("li",{"data-li":"menu"},t.createElement("ul",{className:f.mobileMenu},a.menu.map((function(e,n){return e.subitems.length>0?t.createElement("li",{key:n},t.createElement(O,{controlId:"mobile-menu-popover",placement:n<a.menu.length-3?"top":"topEnd",trigger:"click",ref:s,speaker:t.createElement(yt,{items:e.subitems,onClose:r})},t.createElement("label",null,e.name))):t.createElement("li",{key:n,onClick:function(t){t.preventDefault(),e.onClick(),r()}},t.createElement("label",null,e.name))}))))))):t.createElement(z,{appearance:"subtle"},t.createElement(z.Brand,{style:{cursor:"default"}},t.createElement("strong",null,o.project.name)),t.createElement(p,{onSelect:d,activeKey:u,style:{whiteSpace:"unset"}},a.menu.map((function(e,n){return e.subitems.length>0?t.createElement(j,{key:n,eventKey:n,placement:"topStart",title:e.name},e.subitems.map((function(e,r){var o=n+"-"+r;return t.createElement(j.Item,{key:o,eventKey:o,disabled:m,onClick:function(){return e.onClick()}},t.createElement("div",{className:f.dropdownItem},e.preview_small?t.createElement("img",{src:e.preview_small}):"",e.name))}))):t.createElement(p.Item,{key:n,eventKey:n.toString(),disabled:m,onClick:function(t){t.preventDefault(),e.onClick()}},e.name)})))))))})),wt=function(){return ke().project.exist?t.createElement(H.Slide,{in:!0,placement:"bottom"},(function(e,n){return t.createElement(Et,Object.assign({},e,{ref:n}))})):t.createElement("div",null)},bt=s.createUseStyles({progressRoot:{position:"absolute",zIndex:1040,top:27,left:"calc((100vw - 200px) / 2)",right:0,width:200,pointerEvents:"none"},progress:{display:"flex",alignItems:"center",textShadow:"1px 1px rgba(0,0,0, .2)","& .rs-progress-line-outer":{border:"solid 1px rgba(0,0,0, .1)","& .rs-progress-line-inner":{backgroundColor:"rgba(255,255,255, .3)"}}}}),Ct=function(){var e=bt(),n=Le(),r=Te(),o=t.useState(!1),i=o[0],a=o[1],c=n.state.config.secondsToKill||0,s=n.state.config.secondsToKillLeft||0,l=n.computed.streaming.active;return t.useEffect((function(){l?(!i&&c>0&&a(!0),i&&s>0&&r.start(s)):r.stop()}),[l,s]),i?t.createElement(H.Slide,{in:r.active&&l,placement:"top"},(function(n,o){return t.createElement("div",{className:e.progressRoot},t.createElement("div",Object.assign({},n,{ref:o}),t.createElement("div",{className:e.progress},t.createElement(D.Line,{showInfo:!1,strokeColor:"#fff",percent:r.percent,status:"active"}),t.createElement("div",{style:{width:60}},r.time))))})):t.createElement("div",null)},St={"@global":{body:{overscrollBehavior:"contain"},".rs-drawer-wrapper":{pointerEvents:"none","& *":{pointerEvents:"all"}},".rs-drawer":{backdropFilter:"blur(5px)",borderLeft:"solid 1px rgba(255, 255, 255, .2)"},".rs-drawer-content":{backgroundColor:"rgba(0, 0, 0, .8)"},".rs-sidenav-default":(it={backgroundColor:"transparent","& .rs-dropdown-toggle, & .rs-sidenav-item":{backgroundColor:"transparent"}},it["& .rs-dropdown.rs-dropdown-open .rs-dropdown-toggle,\n        & .rs-dropdown .rs-dropdown-toggle,\n        & .rs-sidenav-item,\n        & .rs-dropdown-toggle,\n        & .rs-sidenav-item"]={backgroundColor:"transparent","&:hover":{backgroundColor:"rgba(255, 255, 255, .3)"}},it),".rs-toast.rs-notification":{width:320},".rs-notification":{width:"100%"}}},kt=s.createUseStyles(G({},St,{root:{margin:0,backgroundColor:"black",height:"var(--window - height)",overflow:"hidden","& #player":{"& video":{position:"fixed",top:0,left:0,right:0,bottom:50,zIndex:0,objectFit:"var(--player-object-fit)",cursor:"pointer"}}},toolbar:{position:"fixed",zIndex:1049,top:20,right:20,display:"flex",flexDirection:"column",gap:10}}));Object.defineProperty(exports,"jss",{enumerable:!0,get:function(){return s.createUseStyles}}),exports.ContextProvider=function(e){return t.createElement(n,{theme:"dark"},t.createElement(xe,null,t.createElement(Ne,null,e.children)))},exports.CustomDrawer=Pe,exports.CustomModal=Ve,exports.Player=function(e){var n=kt(),r=Le(),o=ke(),i=e.apiKey,a=e.metaConfig,c=e.config,s=e.psConfig,l=e.ueSettings,u=t.useState(!1),d=u[0],m=u[1];return t.useEffect((function(){o.cls.setApiKey(i),o.cls.initMetaConfig(a),r.cls.initConfig(c,s,l)}),[]),t.useEffect((function(){if(!1===d&&o.project.config){var e=o.project.config,t=e.ue_console_mode,n=e.ue_control_scheme,i=e.ue_sound;o.cls.initMetaConfig({showQuickMenu:e.menu}),l.Console.mode=t,s.controlScheme=n,s.startVideoMuted=!i,m(!0),r.cls.initConfig(c,s,l)}}),[o.project.config]),t.createElement("div",{className:n.root},t.createElement("div",{id:"player"}),t.createElement(Ae,{isFirst:!0}),o.config.showOverlay&&t.createElement($e,null),o.config.showQuickMenu&&t.createElement(wt,null),t.createElement(Ct,null),(o.config.showToolbar||o.config.showDevBar)&&t.createElement("div",{className:n.toolbar,id:"metaeditor-toolbar"},o.config.showDevBar&&t.createElement(Xe,null),o.config.showToolbar&&t.createElement(pt,null)))},exports.Request=ge,exports.SvgIcon=nt,exports.colors={primary:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},success:{50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"}},exports.config=he,exports.media=De,exports.useMedia=vt,exports.usePlayer=Le,exports.useStorage=we,exports.useSystem=ke;
//# sourceMappingURL=pixel-streaming.cjs.production.min.js.map
